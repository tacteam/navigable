(function(){"use strict";angular.module("module.tac.navigable",[])}).call(this),function(){"use strict";angular.module("module.tac.navigable").factory("tac.navigable.extensible",["$rootScope",function(a){var b,c,d,e;return e=!1,c=function(a,b){return e&&console.log(a.identifier+" handle "+b),!0},d=function(a,b){return e&&console.log(a.identifier+" creation "),!0},b=function(){return{up:function(){return!1},down:function(){return!1},left:function(){return!1},right:function(){return!1},enter:function(){return!1}}},{create_basic:function(c){var e;return d(this),e=[],{identifier:c,root:function(){return this.parent.root()},bind_on_destroy:function(a){var b;return b=a.scope.$on("$destroy",function(){return b(),a.parent.remove(a)})},remove_on_destroy:function(){return this.scope?this.bind_on_destroy(this):this.remove_on_destroy_flag=!0,this},set_priority:function(a){return this.priority=a,this},on_change:function(a){return e.push(a),function(){return _.remove(e,a)}},after_change:function(){var a,b,c,d;for(d=[],b=0,c=e.length;c>b;b++)a=e[b],d.push(a(this));return d},safe_apply:function(b){var c;return c=a.$$phase,"$apply"!==c&&"$digest"!==c?b.$apply():void 0},apply:function(){},remove_child_components:function(){return this.components.length=0,this.current_component=null,this},bind_to:function(a,b){var c;return c=this,this.scope=a,b||a.$parent.add_navigable_component(this),this.apply=function(){return this.safe_apply(a)},a.add_navigable_component=function(a,b){return c.add(a,b)},a.remove_navigable_component=function(a){return c.remove(a)},this.remove_on_destroy_flag&&this.bind_on_destroy(this),this},set_current_in_background:function(a){return this.current_component=a,this.after_change()},set_current_component:function(a,b){var c,d;return d=this.current_component,c=a.set_active(b),c&&(this.current_component=a,d&&d!==a&&d.set_not_active()),c},set_active_down_to_up:function(a,b){var c;return this.active=!0,c=this.current_component!==a,c&&this.set_current_component(a),b?c||this.parent.current_component!==this?this.parent.set_active_down_to_up(this,!0):this.apply():void 0},set_first_child:function(){var a,b;for(b=!1,a=0;!b&&a<this.components.length;)b=this.set_current_component(this.components[a]),a+=1;return b},set_last_child:function(){var a,b;for(b=!1,a=this.components.length-1;!b&&a>=0;)b=this.set_current_component(this.components[a]),a-=1;return b},set_previous_child:function(){return this.current_component&&this.set_current_component(this.current_component)},set_some_child:function(){return this.set_previous_child()||this.set_first_child()},set_active:function(a,b){return this.active||(b?this.active=!0:this.active=this.set_some_child()),a&&this.parent.set_active_down_to_up(this,!0),this.active},set_not_active:function(a){return this.active=!1,this.current_component&&this.current_component.set_not_active(),a?this.parent.set_not_active(!0):void 0},add:function(a,b){var c,d,e,f,g;if(this.components.indexOf(a)>-1)return console.error("trying to add same element twice ["+a.identifier+"]");for(a.parent=this,a.priority=a.priority||b||0,d=0,g=this.components,e=0,f=g.length;f>e;e++)c=g[e],c.priority<a.priority&&(d+=1);return this.components.splice(d,0,a)},remove:function(a){return _.remove(this.components,a),this.current_component===a?(this.current_component=null,this.set_not_active(!0)):void 0},handle_on_selected:function(a){return this.selected&&this.selected.handle(a)},handle_inner:function(a){var b,c;return b=this.handlers[a],c=b&&b(this),c&&this.after_change(),c},handle_by_child:function(a){return this.current_component&&this.current_component.handle(a)},handle:function(a){return this.handle_by_child(a)||this.handle_inner(a)},current_index:function(){return this.components.indexOf(this.current_component)},last_index:function(){return this.components.length-1},initialize:function(){return this.components=[],this.handlers=b(),this},and_extend:function(a){return this.handlers=angular.extend(this.handlers,a),this},go_forward:function(a){var b,c,d;return b=this.current_index(),c=this.last_index(),b>-1&&c>=b+a?(d=this.set_current_component(this.components[b+a]),this.apply(),d):!1},go_back:function(a){var b,c;return b=this.current_index(),b>-1&&b-a>=0?(c=this.set_current_component(this.components[b-a]),this.apply(),c):!1},previous_activable:function(a){var b,c,d;for(d=this.current_index()-1,c=0,b=!1;!b&&d>=c;)b=this.set_current_component(this.components[d]),d-=1;return b&&this.apply(),b},next_activable:function(){var a,b,c;for(c=this.current_index()+1,b=this.last_index(),a=!1;!a&&b>=c;)a=this.set_current_component(this.components[c]),c+=1;return a&&this.apply(),a}}},create_horizontal:function(a){return this.create_basic(a).initialize().and_extend({left:function(a){return a.previous_activable()},right:function(a){return a.next_activable()}})},create_vertical:function(a){return this.create_basic(a).initialize().and_extend({up:function(a){return a.previous_activable()},down:function(a){return a.next_activable()}})},create_multiline:function(a,b){return this.create_basic(a).initialize().and_extend({left:function(a){return a.current_index()%b!==0?a.previous_activable():!1},right:function(a){return(a.current_index()+1)%b!==0?a.next_activable():!1},up:function(a){return a.go_back(b)},down:function(a){return a.go_forward(b)}})}}}])}.call(this),function(){"use strict";angular.module("module.tac.navigable").service("tac.navigable.fail.service",[function(){var a;return a=[],{on_fail:function(b){return a.push(b)},process:function(){var b,c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(b());return e}}}])}.call(this),function(){"use strict";angular.module("module.tac.navigable").factory("tac.navigable.leaf",["$injector",function(a){var b,c,d;return d=function(a,b){return"text"===b[0].type?(a.on_active(function(){return b[0].focus()}),a.on_not_active(function(){return b[0].blur()})):void 0},b=function(b,c,d){return c.openEditor?b.click=function(){var e,f,g;return f=c.openEditor,g=a.get(f),e=g.edit(d.val()),e.done(function(a){return d.val(a),d.trigger("input")}),e.exit(function(){return b.set_active()})}:void 0},c=function(a,b){var c,d,e,f;for(f=[],d=0,e=a.length;e>d;d++)c=a[d],f.push(c(b));return f},function(a,e,f){var g;return g={identifier:e.navigableLeafId,handle:function(a){return"enter"===a?(this.click(),!0):!1},on_active_callbacks:[],on_not_active_callbacks:[],on_active:function(a){return this.on_active_callbacks.push(a)},on_not_active:function(a){return this.on_not_active_callbacks.push(a)},set_active:function(){return c(this.on_active_callbacks,this),this.active=!0},set_not_active:function(){return c(this.on_not_active_callbacks,this),this.active=!1},set_navigable_link:function(a){return this.navigable_link=a,d(g,a),this.click=function(){return a.click()}},click:function(){return a.click(),!0}},f&&(g.on_active(function(){return a.addClass(f)}),g.on_not_active(function(){return a.removeClass(f)})),d(g,a),b(g,e,a),g}}]).constant("tac.navigable.leaf.events",{NAVIGABLE_PROCESSED:"navigable_processed"}).directive("navigableLeafModel",["$parse","tac.navigable.leaf","tac.navigable.leaf.events",function(a,b,c){return{link:function(d,e,f){var g,h,i;return h=parseInt(a("$index")(d)),i=a(f.navigableLeafModel)(d),g=b(e,f),i.navigable=g,d.add_navigable_component(g,h),d.set_navigable_link=function(a){return g.set_navigable_link(a)},d.navigable_processed=!0,d.$broadcast(c.NAVIGABLE_PROCESSED),d.$emit(c.NAVIGABLE_PROCESSED,i),f.removeOnDestroy&&d.$on("$destroy",function(){return d.remove_navigable_component(g)}),f.navigableLeafActive?(g.parent.set_current_component(g),g.parent.set_active(!0,!0)):void 0}}}]).directive("navigableLeaf",["$parse","tac.navigable.leaf","tac.navigable.leaf.events",function(a,b,c){return{link:function(c,d,e){var f,g;return f=b(d,e,e.navigableLeafClass),g=parseInt(e.navigableLeaf),e.navigablePriorityModel&&(g=a(e.navigablePriorityModel)(c)),c.add_navigable_component(f,g),e.navigableLeafActive?(f.parent.set_current_component(f),f.parent.set_active(!0,!0)):void 0}}}]).directive("navigableLink",["$parse","tac.navigable.leaf.events",function(a,b){return{link:function(a,c,d){return a.navigable_processed?a.set_navigable_link(c):a.$on(b.NAVIGABLE_PROCESSED,function(){return a.set_navigable_link(c)})}}}])}.call(this),function(){"use strict";angular.module("module.tac.navigable",[])}.call(this),function(){"use strict";angular.module("module.tac.navigable").factory("tac.navigable.panel.extender",[function(){var a;return a={up:"down",down:"up",right:"left",left:"right"},{process_default_navigation:function(b,c){return b.set_some_child=function(){var b,d,e,f,g;e=this.root().last_action,f=a[e],g=c.from;for(d in g)if(b=g[d],f===d)return this["set_"+b+"_child"]();return c["default"]?this["set_"+c["default"]+"_child"]():this.set_first_child()}},process_default_navigation_string:function(a,b){return b?this.process_default_navigation(a,JSON.parse(b.replace(/'/g,'"'))):void 0}}}]).factory("tac.navigable.panel",["$parse","tac.navigable.panel.extender",function(a,b){return function(c,d,e){var f;return f=e.priority,e.priorityModel&&(f=a(e.priorityModel)(d)),c.set_priority(f),b.process_default_navigation_string(c,e.defaultNavigation),c}}]).controller("tac.navigable.vertical",["$scope","$attrs","tac.navigable.extensible","tac.navigable.panel",function(a,b,c,d){return a.navigable=d(c.create_vertical(b.identifier),a,b).bind_to(a)}]).controller("tac.navigable.horizontal",["$scope","$attrs","tac.navigable.extensible","tac.navigable.panel",function(a,b,c,d){return a.navigable=d(c.create_horizontal(b.identifier),a,b).bind_to(a)}])}.call(this),function(){"use strict";angular.module("module.tac.navigable").factory("tac.navigable.root",["tac.navigable.extensible","tac.navigable.fail.service",function(a,b){return function(c){var d;return d=a.create_basic(c).initialize(),d.fail=function(){return b.process(),!1},d.handle_inner=function(a){return!this.active&&!_.isEmpty(this.components)&&this.set_child_active()||this.fail()},d.root=function(){return this},d.handle=function(a){var b;return b=a.is_number?"number_"+a.number:a.key,this.last_action=b,this.handle_by_child(b)||this.handle_inner(b)},d.set_child_active=function(){var a;for(a=0;!this.active&&a<this.components.length;)this.active=this.set_current_component(this.components[a]),a+=1;return this.active&&this.current_component.apply(),this.active},d.set_active_down_to_up=function(a,b){return this.active=!0,this.set_current_component(a),b?this.apply():void 0},d.set_not_active=function(){return this.active=!1,this.current_component?this.current_component.set_not_active():void 0},d.bind_to=function(a){var b;return b=this,a.add_navigable_component=function(a,c){return b.add(a,c)},this},d}}]).factory("tac.navigable.root.main",["$rootScope","tac.navigable.root",function(a,b){var c;return c=b("root"),a.$on("$routeChangeStart",function(){return c.set_not_active()}),c}])}.call(this);